import * as React from 'react';
import { isFetchedDataSuccess } from '../../../../../api/src/stores/cache-tools/fetched-data';
import { compactMap } from '../../../../../api/src/utils/array-utils';
import { LoadingState } from '../../../../../types/loading-state';
import { bemClassBuilderFactory } from '../../../utils/bem-class-builder';
import { ShowtimePickerFilmListShowtimesSkeleton } from '../loaders/showtime-picker-film-list-skeleton';
import { ShowtimePickerFilm } from './showtime-picker-film';
export var ShowtimePickerFilmList = function (_a) {
    var filmIds = _a.filmIds, siteIds = _a.siteIds, showtimesData = _a.showtimesData, onShowtimeClicked = _a.onShowtimeClicked, browsingStore = _a.browsingStore, config = _a.config, displayText = _a.displayText;
    var showtimes = isFetchedDataSuccess(showtimesData) ?
        compactMap(showtimesData.payload, function (showtimeId) { return browsingStore.data.showtimesById.get(showtimeId); }) :
        [];
    var filmIdsToDisplay = filmIds && filmIds.length > 0
        ? filmIds
        : Array.from(new Set((showtimes || []).map(function (s) { return s.filmId; })));
    var b = bemClassBuilderFactory('v-showtime-picker-film-list');
    switch (showtimesData.loadingState) {
        case LoadingState.Success:
            return (React.createElement("ul", { className: b.block() }, filmIdsToDisplay.map(function (filmId) {
                return React.createElement("li", { className: b.element('item'), key: filmId },
                    React.createElement(ShowtimePickerFilm, { filmId: filmId, siteIds: siteIds, showtimes: (showtimes || []).filter(function (showtime) { return showtime.filmId === filmId; }), onShowtimeClicked: onShowtimeClicked, browsingStore: browsingStore, config: config, displayText: displayText }));
            })));
        case LoadingState.NotLoaded:
        case LoadingState.Loading:
            return (React.createElement(ShowtimePickerFilmListShowtimesSkeleton, { numberOfFilms: filmIds.length > 0 ? filmIds.length : 2, numberOfSites: siteIds.length > 0 ? siteIds.length : 2, showFilmDetails: config.showFilmDetails, showSiteDetails: config.showSiteDetails }));
        case LoadingState.Failure:
            return null;
    }
};
//# sourceMappingURL=showtime-picker-film-list.js.map